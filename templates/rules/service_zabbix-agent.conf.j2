# {{ ansible_managed }}


{% set ferm_zabbix_server = [ "0.0.0.0", "::" ] %}
{% if ansible_local.zabbix_agent.servers is defined %}
{%    set ferm_zabbix_server = ansible_local.zabbix_agent.servers %}
{% endif %}
{% if zabbix_agent_config_server is defined %}
{%    set ferm_zabbix_server = zabbix_agent_config_server %}
{% endif %}
@def $HOST_ZABBIX_SERVER = ({{ ferm_zabbix_server | join(" ") }});

domain $FERM_DOMAINS table filter chain INPUT {
    interface $IF_MNGT proto tcp dport 10050 subchain "IN-ZABBIX" {
        saddr (@ipfilter($HOST_ZABBIX_SERVER)) ACCEPT;
    }
}
